import pandas as pd

# Import all the tweet data
data = pd.read_json(r"tweets.json", lines=True)

# Remove all useless fields we don't need as part of sentiment analysis
del data['id']
del data['conversation_id']
del data['created_at']
del data['timezone']
del data['user_id']
del data['username']
del data['name']
del data['place']
del data['language']
del data['mentions']
del data['urls']
del data['replies_count']
del data['retweets_count']
del data['likes_count']
del data['hashtags']
del data['cashtags']
del data['link']
del data['retweet']
del data['quote_url']
del data['thumbnail']
del data['near']
del data['geo']
del data['source']
del data['user_rt_id']
del data['user_rt']
del data['retweet_id']
del data['reply_to']
del data['retweet_date']
del data['translate']
del data['trans_src']
del data['trans_dest']
del data['photos']
del data['time']

# Export data
data.to_csv(r"cleaned_twitter_data.csv", index=False, header=True)

# We can use the same dataset to generate some additional information that may be useful
# Reimport and create one data frame with media information and another data frame with just tweets
df1 = pd.read_csv("cleaned_twitter_data.csv")
del df1['video']
df2 = pd.read_csv("cleaned_twitter_data.csv")
del df2['tweet']

# Group these by dates and figure out the sum of tweets per day
df2 = df2.groupby('date', as_index=False).sum()

# Merge these with each other and group it by date again
aggregate = pd.merge(df1, df2, on='date')
aggregate = df2.groupby('date', as_index=False)

# Calculate the sum of media into a new CSV file
aggregate.sum().reset_index()[['date', 'video']].to_csv('pictureData.csv', index=False)

# Repeat this process except do this to find the sum of tweets per day into a new CSV file
number_of_tweets = pd.read_csv(r"cleaned_twitter_data.csv")
del number_of_tweets['video']
number_of_tweets = number_of_tweets.groupby('date', as_index=False).count()
number_of_tweets.to_csv(r"tweetsPerDay.csv", index=False, header=True)

# All three CSV files generated by this Python file will be utilized in the main.py file
